<html>

<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Power BI Embedded Demo</title>
    <script type="text/javascript" language="javascript"
        src="https://rawgit.com/Microsoft/PowerBI-JavaScript/master/dist/powerbi.min.js"></script>
    </script>
</head>

<body>
    <div id="reportContainer" style="width: 100%; height: 100%;"></div>
</body>

<script>
    (() => {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const reportId = urlParams.get('reportId');
        const embedUrl = urlParams.get('embedUrl');
        const token = urlParams.get('token');
        var models = window['powerbi-client'].models;

        var embedConfiguration = {
            type: 'report',
            id: reportId,
            embedUrl: embedUrl,
            tokenType: models.TokenType.Embed,
            accessToken: token
        };
        var $reportContainer = document.getElementById('reportContainer');
        var report = powerbi.embed($reportContainer, embedConfiguration);


        // $.ajax({
        //     url: getEmbedToken,
        //     jsonpCallback: 'callback',
        //     contentType: 'application/javascript',
        //     dataType: "jsonp",
        //     success: function (json) {

        //         var models = window['powerbi-client'].models;

        //         var embedConfiguration = {
        //             type: 'report',
        //             id: json.ReportId,
        //             embedUrl: json.EmbedUrl,
        //             tokenType: models.TokenType.Embed,
        //             accessToken: json.EmbedToken
        //         };

        //         var $reportContainer = $('#reportContainer');
        //         var report = powerbi.embed($reportContainer.get(0), embedConfiguration);


        //     },
        //     error: function () {
        //         alert("Error");
        //     }
        // });

    })();
</script>

</html>